<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Treinos</title>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f6f7fb;
    --glass: rgba(255,255,255,.6);
    --stroke: rgba(0,0,0,.06);
    --text:#1b1b1d;
    --muted:#6b6f76;
    --accent:#1f7aec;
    --success:#15b56b;
    --warning:#ffb020;
    --danger:#ff5a7a;
    --shadow: 0 10px 30px rgba(30,35,55,.08);
    --radius: 16px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:"Sora",system-ui,-apple-system,Segoe UI,Roboto,Arial;
    background: var(--bg);
    color: var(--text);
  }

  /* Header glass */
  header{
    position:sticky;top:0;z-index:50;
    backdrop-filter: blur(10px);
    background: rgba(255,255,255,.55);
    border-bottom:1px solid var(--stroke);
    box-shadow: 0 6px 20px rgba(0,0,0,.05);
  }
  .bar{
    max-width:1100px;margin:0 auto;
    display:flex;align-items:center;gap:14px;
    padding:14px 18px;
  }
  .spacer{flex:1}

  /* Botão/link Dieta com efeito (não é título) */
  .btn-dieta{
    position:relative;
    font-weight:800;
    font-size:20px;
    letter-spacing:.4px;
    text-decoration:none;
    padding:6px 12px;
    border-radius:12px;
    display:inline-flex;align-items:center;gap:10px;
    isolation:isolate;
  }
  .btn-dieta .label{
    background: linear-gradient(90deg,#2e2e2f,#3c3d3f,#5a5c60,#2e2e2f);
    background-size:200% 100%;
    -webkit-background-clip:text;
    background-clip:text;
    -webkit-text-fill-color:transparent;
    animation: gradientShift 8s linear infinite;
    text-shadow: 0 2px 4px rgba(0,0,0,.12);
  }
  .btn-dieta::after{
    content:"";
    position:absolute; inset:0;
    border-radius:12px;
    background: radial-gradient(120px 40px at var(--x,0%) 50%, rgba(255,255,255,.35), transparent 60%);
    mix-blend-mode: screen;
    pointer-events:none;
  }
  .btn-dieta:hover{filter:saturate(1.05)}
  .btn-dieta:active{transform: translateY(1px)}

  @keyframes gradientShift{0%{background-position:0% 50%}100%{background-position:200% 50%}}

  /* Buttons top */
  .icon-btn{
    display:inline-flex;align-items:center;justify-content:center;
    width:38px;height:38px;border-radius:12px;border:1px solid var(--stroke);
    background: var(--glass);
    box-shadow: var(--shadow);
    cursor:pointer;
    transition:.2s ease;
  }
  .icon-btn:hover{transform:translateY(-1px)}
  .icon-btn:active{transform:translateY(0)}

  /* Assistente indicador */
  .icon-assist[data-state="on"]{outline:2px solid rgba(21,181,107,.25)}
  .icon-assist[data-state="text"]{outline:2px solid rgba(31,122,236,.25)}
  .icon-assist[data-state="off"]{opacity:.65}

  /* Container principal */
  .wrap{max-width:1100px;margin:22px auto;padding:0 18px 60px}

  /* Toolbar seção */
  .section{
    background: var(--glass);
    border:1px solid var(--stroke);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    margin-bottom:20px;
    overflow:hidden;
  }
  .section-header{
    display:flex;align-items:center;gap:10px;
    padding:14px 16px;
    cursor:pointer;
    user-select:none;
  }
  .section-title{font-weight:700}
  .counter{font-weight:600;color:var(--muted);margin-left:auto}

  .toggle{width:28px;height:28px;border-radius:10px;border:1px solid var(--stroke);display:grid;place-items:center;background:rgba(255,255,255,.6)}
  .toggle span{font-size:16px;line-height:1}

  .section-body{padding:6px 14px 16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px}
  .card{
    position:relative;
    background: rgba(255,255,255,0.72);
    border:1px solid var(--stroke);
    border-radius: 16px;
    box-shadow: var(--shadow);
    padding:12px;
    overflow:hidden;
    transition: transform .2s ease, box-shadow .2s ease, background .3s ease;
  }
  .card:hover{transform:translateY(-2px); box-shadow:0 14px 34px rgba(0,0,0,.08)}
  .card.completed{background: rgba(245,255,249,.86)}
  .card .title{font-weight:700;margin:2px 0 6px;font-size:14px}
  .meta{color:var(--muted);font-size:12px;margin:0 0 8px}

  /* Video */
  .vid-wrap{position:relative;border-radius:12px;overflow:hidden}
  video{
    width:100%;height:auto;display:block;
  }
  .vid-overlay{
    position:absolute;inset:0;display:grid;place-items:center;
    background: rgba(0,0,0,.0);
    opacity:0; transition: opacity .2s ease, background .25s ease;
    pointer-events:none;
  }
  .vid-wrap.paused .vid-overlay{opacity:1;background:rgba(0,0,0,.18)}
  .vid-icon{
    width:62px;height:62px;border-radius:50%;display:grid;place-items:center;
    background: rgba(255,255,255,.9); border:1px solid var(--stroke); box-shadow: var(--shadow);
    font-size:22px;
  }

  .row{display:flex;align-items:center;gap:8px;margin-top:10px}
  .btn{
    padding:8px 10px;border-radius:10px;border:1px solid var(--stroke);
    background:rgba(255,255,255,.8);box-shadow:var(--shadow);cursor:pointer;
    font-weight:600;font-size:12px;
  }
  .btn:active{transform:translateY(1px)}

  .btn-intervalo{display:inline-flex;align-items:center;gap:6px}
  .btn-concluir{display:inline-flex;align-items:center;gap:6px;background:rgba(21,181,107,.12);border-color:rgba(21,181,107,.25)}

  /* Temporizador flutuante dentro do card */
  .timer{
    position:absolute;inset:0;display:none;align-items:center;justify-content:center;
    background: rgba(255,255,255,.86); backdrop-filter: blur(4px);
  }
  .timer.on{display:flex}
  .timer-circle{
    width:140px;height:140px;border-radius:50%;
    background: conic-gradient(var(--accent) var(--deg,0deg), rgba(0,0,0,.08) 0);
    display:grid;place-items:center;
    transition: filter .3s ease;
  }
  .timer.paused .timer-circle{filter: saturate(.5)}
  .timer-num{font-weight:800;font-size:26px;color:#222}

  /* Toast fila */
  .toast{
    position:fixed;left:16px;bottom:16px;z-index:80;pointer-events:none;
    display:flex;flex-direction:column;gap:8px;
  }
  .toast .item{
    pointer-events:auto;
    background: rgba(255,255,255,.94);
    border:1px solid var(--stroke);
    box-shadow: var(--shadow);
    border-radius: 14px;
    padding:10px 12px;font-size:13px;color:#222;
    animation: pop .25s ease;
    display:flex;align-items:center;gap:8px;
  }
  @keyframes pop{from{transform:translateY(6px);opacity:0}to{transform:translateY(0);opacity:1}}

  /* Painel da assistente */
  .panel{
    position:fixed;right:16px;bottom:16px;z-index:70;
    background: rgba(255,255,255,.92);border:1px solid var(--stroke);box-shadow: var(--shadow);
    border-radius:16px;padding:12px;min-width:240px;display:none;
  }
  .panel.show{display:block}
  .panel h4{margin:0 0 8px}
  .panel .opt{display:flex;gap:8px}
  .panel .opt button{flex:1}

  /* Indicador visual sutil no canto */
  .indicator{
    position:fixed;left:12px;bottom:72px;width:10px;height:10px;border-radius:999px;
    background: #8aa0b8; opacity:.35; box-shadow:0 0 0 0 rgba(31,122,236,.35);
    transition:.3s;
  }
  .indicator.talking{
    opacity:.9; box-shadow:0 0 0 10px rgba(31,122,236,.0);
    animation: pulse 1.4s ease infinite;
  }
  @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(31,122,236,.35)}70%{box-shadow:0 0 0 12px rgba(31,122,236,0)}100%{box-shadow:0 0 0 0 rgba(31,122,236,0)}}

  /* Expandir/Recolher global */
  .top-controls{display:flex;align-items:center;gap:10px}

  /* Discreto: micro feedback concluir */
  .ripple{
    position:absolute;inset:-2px;border-radius:16px;pointer-events:none;
    background: radial-gradient(600px 80px at 50% -10%, rgba(21,181,67,.22), transparent 70%);
    opacity:0;transition:.4s;
  }
  .card.completed .ripple{opacity:1}

  /* Esconde setinhas redundantes originais: agora só ícone concluir circular */
  .done-dot{
    width:28px;height:28px;border-radius:999px;border:1px solid rgba(21,181,107,.25);
    background: rgba(21,181,107,.12);display:grid;place-items:center;font-size:14px;cursor:pointer;
  }

  /* Acessibilidade touch */
  @media (hover:none){
    .icon-btn:hover{transform:none}
    .card:hover{transform:none}
  }

  /* Ícones no canto inferior direito */
  .floating-icons{
    position:fixed;right:16px;bottom:16px;z-index:90;
    display:flex;flex-direction:column;gap:10px;
  }
  .floating-icons .icon{
    width:46px;height:46px;border-radius:50%;
    background: rgba(255,255,255,.6);border:1px solid var(--stroke);
    box-shadow: var(--shadow);
    display:grid;place-items:center;font-size:20px;cursor:pointer;
    transition: transform .25s ease, box-shadow .25s ease;
    animation: idlePulse 6s ease-in-out infinite;
  }
  .floating-icons .icon:hover{transform:scale(1.06);box-shadow:0 6px 18px rgba(0,0,0,.12)}
  .floating-icons .icon:active{transform:scale(0.94)}
  @keyframes idlePulse{0%,100%{opacity:.9}50%{opacity:1}}

  /* Painel Resumo da Semana */
  .overlay{
    position:fixed;inset:0;background:rgba(255,255,255,.55);backdrop-filter:blur(10px);
    display:none;align-items:center;justify-content:center;z-index:100;
  }
  .overlay.show{display:flex}
  .summary{
    background:rgba(255,255,255,.85);border:1px solid var(--stroke);
    box-shadow:var(--shadow);border-radius:20px;
    padding:24px;max-width:420px;width:90%;text-align:center;position:relative;
  }
  .summary h3{margin:0 0 10px;font-weight:800}
  .summary p{margin:4px 0;color:var(--muted);font-size:14px}
  .summary .close{
    position:absolute;top:12px;right:12px;width:30px;height:30px;border-radius:50%;
    background:rgba(255,255,255,.6);border:1px solid var(--stroke);
    display:grid;place-items:center;cursor:pointer;
  }
  .week-dots{display:flex;justify-content:space-between;margin:16px 0 6px}
  .week-dots div{
    width:22px;height:22px;border-radius:50%;
    background:rgba(0,0,0,.08);display:grid;place-items:center;font-size:12px;
    transition:all .3s ease;
  }
  .week-dots div.active{background:rgba(21,181,107,.6);color:white;box-shadow:0 0 8px rgba(21,181,107,.4)}
  .week-labels{display:flex;justify-content:space-between;font-size:11px;color:var(--muted)}
  .progress-bar{
    height:8px;background:rgba(0,0,0,.06);border-radius:6px;margin-top:12px;overflow:hidden;
  }
  .progress-fill{
    height:100%;background:var(--accent);width:0%;transition:width .4s ease;border-radius:6px;
  }

  /* Painel Calendário */
  .calendar{
    background:rgba(255,255,255,.85);border:1px solid var(--stroke);
    box-shadow:var(--shadow);border-radius:20px;
    padding:24px;max-width:520px;width:95%;text-align:center;position:relative;
  }
  .calendar h3{margin:0 0 10px;font-weight:800}
  .calendar .close{
    position:absolute;top:12px;right:12px;width:30px;height:30px;border-radius:50%;
    background:rgba(255,255,255,.6);border:1px solid var(--stroke);
    display:grid;place-items:center;cursor:pointer;
  }
  .calendar-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
  .calendar-grid{
    display:grid;grid-template-columns:repeat(7,1fr);gap:4px;font-size:12px
  }
  .calendar-grid div{
    width:28px;height:28px;border-radius:50%;display:grid;place-items:center;
    background:rgba(0,0,0,.05);color:var(--muted)
  }
  .calendar-grid div.active{
    background:rgba(21,181,107,.6);color:white;box-shadow:0 0 6px rgba(21,181,107,.4)
  }
  .calendar-grid .label{background:none;color:var(--muted);font-weight:600}

  /* Dropdown Reset (glass) */
  .reset-menu{
    position:fixed;z-index:120;display:none;
    background:rgba(255,255,255,.92);border:1px solid var(--stroke);box-shadow:var(--shadow);
    border-radius:14px;overflow:hidden;min-width:210px;
  }
  .reset-menu.show{display:block}
  .reset-menu button{
    display:block;width:100%;text-align:left;padding:10px 12px;border:0;background:transparent;cursor:pointer;
    font-family:inherit;font-size:13px;
  }
  .reset-menu button:hover{background:rgba(0,0,0,.04)}
</style>
</head>
<body>
  <header onmousemove="event.target.closest('.btn-dieta') && event.target.closest('.btn-dieta').style.setProperty('--x', (event.offsetX/this.offsetWidth*100)+'%')">
    <div class="bar">
      <video autoplay muted loop playsinline style="width:42px;height:42px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);object-fit:cover;"><source src="https://cdn.dribbble.com/userupload/41574436/file/original-272d6c96cfeb527eb907a1c1cf06f828.mp4" type="video/mp4"></video>
      <div class="spacer"></div>

      <a class="btn-dieta" href="dieta.html" title="Abrir Dieta">
        <span class="label">Dieta</span>
      </a>

      <div class="top-controls">
        <button class="icon-btn" id="btnReset" title="Reset">⟲</button>
        <button class="icon-btn" id="toggleAll" title="Expandir/Recolher seções">＋</button>
        <button class="icon-btn icon-assist" id="btnAssist" data-state="on" title="Assistente">💡</button>
      </div>
    </div>
  </header>

  <!-- wrap: mantive a estrutura original, adicionei a seção do PDF antes do container #app -->
  <div class="wrap">
    <!-- Seção do PDF (aba única) -->
    <div class="section">
      <div class="section-header">
        <div class="section-title">📄 PDF do Treino</div>
      </div>
      <div class="section-body" style="display:block">
        <div class="card" style="text-align:center">
          <a href="PDF TREINO.pdf" download class="btn" style="font-size:14px;font-weight:700;display:inline-block;margin:10px auto">
            ⬇ Baixar PDF
          </a>
          <p style="margin-top:16px;color:var(--muted);font-size:13px">
            Apenas um molde rápido do que adicionei, vou melhorar e organizar melhor.<br>
            Espero que goste.<br><br>
            Vou dar uma pausa, pois estou doente e não estou bem.
          </p>
        </div>
      </div>
    </div>

    <div class="wrap-inner">
      <!-- container dinâmico de seções (mantive ID original para o script) -->
      <div id="app"></div>
    </div>
  </div>

  <!-- Toasts -->
  <div class="toast" id="toast"></div>
  <!-- Painel assistente -->
  <div class="panel" id="panel">
    <h4>Assistente</h4>
    <div class="opt">
      <button class="btn" data-mode="on">Texto + Voz</button>
      <button class="btn" data-mode="text">Só Texto</button>
      <button class="btn" data-mode="off">Off</button>
    </div>
    <small style="display:block;margin-top:8px;color:var(--muted)">
      A assistente inicia ligada. O estado fica salvo no navegador.
    </small>
  </div>
  <!-- Indicador sutil -->
  <div class="indicator" id="indicator"></div>

  <!-- Ícones flutuantes -->
  <div class="floating-icons">
    <div class="icon" id="iconSummary" title="Resumo da Semana">📈</div>
    <div class="icon" id="iconExtra" title="Calendário">🗓️</div>
  </div>

  <!-- Overlay Resumo da Semana -->
  <div class="overlay" id="overlaySummary">
    <div class="summary">
      <div class="close" id="closeSummary">✕</div>
      <h3>Resumo da Semana 🌱</h3>
      <p id="weekInfo"></p>
      <div class="week-dots" id="weekDots"></div>
      <div class="week-labels"><span>Seg</span><span>Ter</span><span>Qua</span><span>Qui</span><span>Sex</span><span>Sáb</span><span>Dom</span></div>
      <div class="progress-bar"><div class="progress-fill" id="weekProgress"></div></div>
    </div>
  </div>

  <!-- Overlay Calendário -->
  <div class="overlay" id="overlayCalendar">
    <div class="calendar">
      <div class="close" id="closeCalendar">✕</div>
      <div class="calendar-header">
        <button class="btn" id="prevMonth">⬅</button>
        <h3 id="calTitle"></h3>
        <button class="btn" id="nextMonth">➡</button>
      </div>
      <div class="calendar-grid" id="calGrid"></div>
    </div>
  </div>

  <!-- Dropdown Reset (injetado dinamicamente perto do botão) -->
  <div class="reset-menu" id="resetMenu">
    <button id="resetTreinos">🔄 Resetar treinos</button>
    <button id="resetResumo">📈 Resetar resumo</button>
    <button id="resetCalendario">🗓️ Resetar calendário</button>
  </div>

<script>
/* =========================
   DADOS DOS TREINOS + VÍDEOS
   ========================= */
const SECOES = [
  {
    titulo: "Posterior & Glúteo",
    itens: [
      { t:"Agachamento Sumô com Halteres", meta:"Série: 3x10/10/10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-sumo-squat-front.mp4" },
      { t:"Leg Press 45", meta:"Série: 4x15 (pés juntos) + 15 (afastados) | Carga: 12kg | Intervalo: 40s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-leg-press-front.mp4" },
      { t:"Adução de Quadril Máquina", meta:"Série: 3x10/10/10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-machine-hip-adduction-front.mp4" },
      { t:"Cadeira Flexora", meta:"Séries: 3x10/10/10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-seated-leg-curl-side.mp4" },
      { t:"Cadeira Flexora Unilateral", meta:"Séries: 3x10/10/10/10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/machines/_1080/Seated_Leg_Curl_FR_1080.mp4" },
      { t:"Panturrilha no Step", meta:"Série: 4x15 | Carga: 0kg | Intervalo: 30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-calves-stretch-variation-3-side.mp4" },
      { t:"Abdominal Canivete", meta:"Série: 4x15 | Carga: 0kg | Intervalo: 30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-suitcase-crunch-side.mp4" },
      { t:"Esteira Caminhada", meta:"Série: 30 reps", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Cardio-treadmill-walk-side.mp4" },
    ]
  },
  {
    titulo: "Quadricípes",
    itens: [
      { t:"Agachamento com barra", meta:"Série: 3x10+10+10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Barbell-barbell-squat-side.mp4" },
      { t:"Abdução de Quadril Máquina", meta:"Séries: 3x10+10+10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-machine-hip-abduction-front.mp4" },
      { t:"Elíptico", meta:"Séries: 25reps | Carga: 0kg", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Cardio-elliptical-side.mp4" },
      { t:"Afundo Búlgaro com Halteres", meta:"Séries: 3x12 3x10 2x8 | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-bulgarian-split-squat-side.mp4" },
      { t:"Agachamento Sumô no Step com Halteres", meta:"Séries: 3x10+10+10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.tenor.com/W8BOcFL1of0AAAPo/agachamento-sum%C3%B4com-halteres-treino-mestre.mp4" },
      { t:"Abdução de Quadril Máquina (alt)", meta:"Séries: 3x10+10+10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/machines/_1080/Hip_Abduction_FR_1080.mp4" },
      { t:"Cadeira Extensora", meta:"Séries: 3x10+10+10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-machine-leg-extension-side.mp4" },
      { t:"Cadeira Extensora Unilateral", meta:"Séries: 3x10+10+10 (Drop) | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/machines/_1080/Single_Leg_Extension_FR_1080.mp4" },
      { t:"Leg Press 45 Unilateral", meta:"Séries: 3x12 3x10 2x8 | Carga: 0kg | Intervalo: 60s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-machine-single-leg-leg-press-side.mp4" },
    ]
  },
  {
    titulo: "Peito, Tríceps e Bíceps",
    itens: [
      { t:"Alongamento de Ombros e Tríceps II", meta:"Séries: 3x20 | Carga: 0kg", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-shoulders-stretch-variation-1-front.mp4" },
      { t:"Bike Spinning Sentada", meta:"Séries: 40 reps", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Cardio-stationary-bike-side.mp4" },
      { t:"Abdominal Supra Solo", meta:"Séries: 5x15 | Carga:0kg | Intervalo: 40s", v:"https://media.tenor.com/z9a6Bypsmu0AAAPo/abdominal-supra-no-solo-treino-mestre.mp4" },
      { t:"Tríceps Unilateral na Polia Alta (Pegada Neutra)", meta:"Séries: 3x15 | Carga:0kg | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Cables-cable-single-arm-rope-pushdown-side.mp4" },
      { t:"Alongamento de Peitoral (Espaldar)", meta:"Séries 3x15 | Carga:0kg | Intervalo: 40s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-chest-stretch-variation-1-side.mp4" },
      { t:"Mobilidade de Ombro III", meta:"Série: 3x20 | Carga: 0kg", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Recovery-thoracic-extensions-via-shoulder-flexion-foam-roller-front.mp4" },
      { t:"Rosca Alternada com Halteres", meta:"Séries: 3x15 | Carga:0kg | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-curl-side.mp4" },
      { t:"Tríceps na Polia com Corda", meta:"Séries: 3x15 Lento + 15 curto | Carga:0kg | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Cables-cable-push-down-side.mp4" },
      { t:"Crucifixo com Halteres", meta:"Séries: 4x12 | Carga:0kg | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-incline-chest-fly-front.mp4" },
      { t:"Crucifixo Inclinado com Halteres", meta:"Séries: 4x12 | Carga:0kg | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-incline-chest-flys-side.mp4" },
      { t:"Rosca Martelo com Halteres", meta:"Séries: 4x12 | Carga:0kg | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-hammer-curl-side.mp4" }
    ]
  },
  {
    titulo: "Ombro e Costas",
    itens: [
      { t:"Desenvolvimento com Halteres (Pegada Neutra)", meta:"Séries: 3x10/8/6 (Drop) | Carga:0kg | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-neutral-overhead-press-side.mp4" },
      { t:"Abdominal Canivete", meta:"Séries: 3x12 | Carga:0kg | Intervalo:30s", v:"https://media.tenor.com/EdPPr1AT2lkAAAPo/abdominal-canivete-treino-mestre.mp4" },
      { t:"Esteira Caminhada", meta:"Séries: 40 reps", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Cardio-treadmill-walk-side.mp4" },
      { t:"Elevação Lateral Unilateral Sentado", meta:"Séries: 3x10/8/6 (Drop) | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-seated-overhead-press-front.mp4" },
      { t:"Elevação Frontal Alternada", meta:"Séries: 3x12 | Carga: 4 a 6kg | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-front-raise-side.mp4" },
      { t:"Puxada alta (pegada neutra)", meta:"Séries: 3x10/8/6 (Drop) | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-machine-pulldown-side.mp4" },
      { t:"Remada Baixa Triângulo", meta:"Séries: 3x10/8/6 (Drop) | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-machine-seated-cable-row-side.mp4" },
      { t:"Remada Baixa (alt)", meta:"Séries: 3x10/8/6 (Drop) | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-machine-seated-cable-row-front.mp4" },
      { t:"Puxada Aberta Barra Reta", meta:"Séries: 3x10/8/6 (Drop) | Intervalo:30s", v:"https://media.musclewiki.com/media/uploads/videos/branded/female-machine-pulldown-side.mp4" }
    ]
  }
];

/* =========================
   RENDER
   ========================= */
const app = document.getElementById('app');
let expandidas = false;
function el(tag, attrs={}, ...children){
  const e = document.createElement(tag);
  Object.entries(attrs).forEach(([k,v])=>{
    if(k==='class') e.className=v;
    else if(k==='html') e.innerHTML=v;
    else if(k.startsWith('on')) e.addEventListener(k.slice(2), v);
    else e.setAttribute(k,v);
  });
  children.forEach(c=> e.appendChild(typeof c==='string'? document.createTextNode(c): c));
  return e;
}

function render(){
  app.innerHTML='';
  SECOES.forEach((sec,si)=>{
    const section = el('div',{class:'section', 'data-index':si});
    const header = el('div',{class:'section-header'});
    const toggle = el('div',{class:'toggle'}, el('span',{}, expandidas?'−':'＋'));
    const title = el('div',{class:'section-title'}, document.createTextNode(sec.titulo));
    const counter = el('div',{class:'counter', id:`counter-${si}`}, document.createTextNode('(0/'+sec.itens.length+')'));
    header.append(toggle,title,counter);
    section.appendChild(header);

    const body = el('div',{class:'section-body', style: expandidas?'':'display:none'});
    sec.itens.forEach((it, idx)=>{
      const card = el('div',{class:'card', 'data-si':si, 'data-i':idx});

      const ripple = el('div',{class:'ripple'});
      const title = el('div',{class:'title'}, document.createTextNode(it.t));
      const meta = el('div',{class:'meta'}, document.createTextNode(it.meta));

      const vidWrap = el('div',{class:'vid-wrap paused'});
      const video = el('video',{src:it.v, preload:"metadata", playsinline:"", disablepictureinpicture:""});
      // Play/Pause ao clique
      video.addEventListener('click', ()=>{
        if(video.paused){ video.play(); vidWrap.classList.remove('paused'); }
        else { video.pause(); vidWrap.classList.add('paused'); }
      });
      video.addEventListener('play', ()=> vidWrap.classList.remove('paused'));
      video.addEventListener('pause', ()=> vidWrap.classList.add('paused'));

      const overlay = el('div',{class:'vid-overlay'}, el('div',{class:'vid-icon'}, document.createTextNode('▶')));
      vidWrap.append(video, overlay);

      const row = el('div',{class:'row'});
      const btnInter = el('button',{class:'btn btn-intervalo'}, document.createTextNode('Intervalo 60s'));
      const done = el('div',{class:'done-dot', title:'Concluir'}, document.createTextNode('✓'));
      row.append(btnInter, done);

      // Temporizador
      const timer = el('div',{class:'timer'});
      const circle = el('div',{class:'timer-circle'});
      const num = el('div',{class:'timer-num'}, document.createTextNode('00:00'));
      const closeBtn = el("button",{class:"icon-btn",style:"position:absolute;top:8px;right:8px;width:28px;height:28px;font-size:14px;opacity:.8",title:"Fechar"},document.createTextNode("✕"));
      closeBtn.addEventListener("click", ()=> hideTimer());
      timer.appendChild(closeBtn);
      circle.appendChild(num); timer.appendChild(circle);

      // Ações
      let completed = false;
      done.addEventListener('click', ()=>{
        completed = !completed;
        card.classList.toggle('completed', completed);
        saveProgress();
        updateCounter(si);
        if(completed){ // loga só quando marcar como concluído
          logWeekSummary();
          logCalendarDate();
          toast('✅ Exercício concluído');
        }else{
          toast('↩ Marcado como não concluído');
        }
      });

      // Temporizador comportamento
      let duration = parseInt((it.meta.match(/Intervalo:\s*(\d+)s/i)||[])[1] || '60', 10);
      btnInter.textContent = `Intervalo ${duration}s`;
      let startAt=0, remain=duration, ticking=false, rafId=null, vibrated5=false;

      function tick(ts){
        if(!startAt) startAt = ts;
        const elapsed = (ts - startAt)/1000;
        const left = Math.max(0, remain - elapsed);
        const deg = (1 - left/duration)*360;
        circle.style.setProperty('--deg', deg+'deg');
        num.textContent = fmt(left);
        if(left <= 5 && !vibrated5){ vibrated5 = true; vibrate5(); }
        if(left>0 && ticking){ rafId = requestAnimationFrame(tick); }
        else if(left<=0){
          ticking=false; timer.classList.remove('paused');
          playEndTone();
          setTimeout(()=> hideTimer(), 600);
          vibrated5=false;
        }
      }
      function fmt(s){
        const m = Math.floor(s/60), ss = Math.floor(s%60);
        return `${String(m).padStart(2,'0')}:${String(ss).padStart(2,'0')}`;
      }
      function showTimer(){
        timer.classList.add('on'); timer.classList.remove('paused');
        // inicia automaticamente
        startAt=0; remain=duration; ticking=true; vibrated5=false; rafId=requestAnimationFrame(tick);
      }
      function hideTimer(){ timer.classList.remove('on'); cancelAnimationFrame(rafId); ticking=false; }
      function pauseTimer(){ ticking=false; timer.classList.add('paused'); remain = Math.max(0, remain - ((performance.now()-startAt)/1000)); }
      function resumeTimer(){ ticking=true; timer.classList.remove('paused'); startAt=0; rafId=requestAnimationFrame(tick); }

      btnInter.addEventListener('click', ()=>{ showTimer(); });
      timer.addEventListener('click', ()=>{
        if(!timer.classList.contains('on')) return;
        if(ticking){ pauseTimer(); }
        else if(remain>0){ resumeTimer(); }
      });

      // Logging helpers (separados)
      function logWeekSummary(){
        const today = new Date();
        const key = getWeekKey(today);
        const store = JSON.parse(localStorage.getItem('weekLogs')||'{}');
        if(!store[key]) store[key] = { days: [], total: 0 };
        const d = today.getDay(); // 0=Dom
        const idx = (d===0?6:d-1);
        if(!store[key].days.includes(idx)) store[key].days.push(idx);
        store[key].total += 1;
        localStorage.setItem('weekLogs', JSON.stringify(store));
      }
      function logCalendarDate(){
        const today = new Date();
        const iso=`${today.getFullYear()}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;
        const arr = JSON.parse(localStorage.getItem('calendarLogs')||'[]');
        if(!arr.includes(iso)){ arr.push(iso); localStorage.setItem('calendarLogs', JSON.stringify(arr)); }
      }

      // Montagem
      card.append(ripple, title, meta, vidWrap, row, timer);
      body.appendChild(card);
    });

    header.addEventListener('click', ()=>{
      const shown = body.style.display !== 'none';
      body.style.display = shown ? 'none' : '';
      syncGlobalToggle();
    });

    section.appendChild(body);
    app.appendChild(section);
  });
}
render();

/* =========================
   Expandir/Recolher global sincronizado
   ========================= */
const toggleAll = document.getElementById('toggleAll');
function syncGlobalToggle(){
  const bodies = [...document.querySelectorAll('.section-body')];
  const allHidden = bodies.every(b=> b.style.display==='none');
  const allShown  = bodies.every(b=> b.style.display!== 'none');
  toggleAll.textContent = allHidden ? "＋" : "−";
}
toggleAll.addEventListener('click', ()=>{
  const bodies = [...document.querySelectorAll('.section-body')];
  const allHidden = bodies.every(b=> b.style.display==='none');
  bodies.forEach(b=> b.style.display = allHidden ? '' : 'none');
  syncGlobalToggle();
});
syncGlobalToggle();

/* =========================
   Contadores de seção e progresso persistente
   ========================= */
function updateCounter(si){
  const sec = document.querySelector(`.section[data-index="${si}"]`);
  const cards = sec.querySelectorAll('.card');
  const done = sec.querySelectorAll('.card.completed').length;
  const total = cards.length;
  sec.querySelector(`#counter-${si}`).textContent = `(${done}/${total})`;
}
function saveProgress(){
  const done = [...document.querySelectorAll('.card')].map(c=> c.classList.contains('completed')?1:0);
  localStorage.setItem('progress', JSON.stringify(done));
}
function loadProgress(){
  const raw = localStorage.getItem('progress'); if(!raw) return;
  const arr = JSON.parse(raw);
  document.querySelectorAll('.card').forEach((c,i)=>{
    if(arr[i]) c.classList.add('completed');
  });
  document.querySelectorAll('.section').forEach((s,si)=> updateCounter(si));
}
window.addEventListener('load', ()=> setTimeout(loadProgress, 0));

/* =========================
   Assistente Minimalista (PT-BR)
   ========================= */
const btnAssist = document.getElementById('btnAssist');
const indicator = document.getElementById('indicator');
const panel = document.getElementById('panel');
const toastBox = document.getElementById('toast');

const MENSAGENS = [
  "💧 Não esqueça de beber água.",
  "✨ Postura: coluna neutra e core firme.",
  "⏱️ Controle o ritmo, sem pressa.",
  "🧘 Respire pelo nariz, solte pela boca.",
  "👏 Excelente! Continue constante.",
  "🦵 Foque na amplitude com segurança.",
  "🔥 Últimas repetições fazem a diferença.",
  "📏 Técnica primeiro, carga depois."
];

let assistMode = localStorage.getItem('assistMode') || 'on';
applyAssistMode(assistMode);
btnAssist.addEventListener('click', ()=>{
  panel.classList.toggle('show');
});
panel.querySelectorAll('[data-mode]').forEach(b=>{
  b.addEventListener('click', ()=>{
    assistMode = b.dataset.mode;
    localStorage.setItem('assistMode', assistMode);
    applyAssistMode(assistMode);
    panel.classList.remove('show');
    toast(`Assistente: ${ assistMode==='on' ? 'Texto + Voz' : assistMode==='text' ? 'Só texto' : 'Desligada' }`);
  });
});
function applyAssistMode(mode){ btnAssist.dataset.state = mode; }

/* Ciclo automático de sugestões */
let msgIndex = 0;
setInterval(()=>{
  if(assistMode==='off') return;
  const m = MENSAGENS[msgIndex];
  toast(m);
  if(assistMode==='on') speak(m); // Fala apenas o texto (sem emojis)
  msgIndex = (msgIndex+1) % MENSAGENS.length;
}, 14000);

/* Falar apenas o texto (PT-BR, sem emojis) */
let asstVoice=null;
function initVoice(){
  const voices = speechSynthesis.getVoices();
  asstVoice = voices.find(v=> v.lang.toLowerCase().startsWith('pt-br') && /female|mulher|brasil|brazil/i.test(v.name))
            || voices.find(v=> v.lang.toLowerCase().startsWith('pt-br'))
            || voices.find(v=> v.lang.toLowerCase().startsWith('pt'))
            || null;
}
if(speechSynthesis.onvoiceschanged!==undefined){ speechSynthesis.onvoiceschanged = initVoice; }
initVoice();
function speak(msg){
  if(!('speechSynthesis' in window)) return;
  let clean = msg.replace(/[^\p{L}\p{N}\p{P}\p{Z}]/gu, ''); // remove emojis
  const u = new SpeechSynthesisUtterance(clean);
  if(asstVoice) u.voice = asstVoice;
  u.lang = 'pt-BR'; u.pitch = 1.03; u.rate = 1; u.volume = 1;
  indicator.classList.add('talking');
  u.onend = ()=> indicator.classList.remove('talking');
  speechSynthesis.speak(u);
}

/* =========================
   Toast com fila (sem poluir)
   ========================= */
const queue = [];
let showing = false;
function toast(text){
  queue.push(text);
  if(!showing) showNext();
}
function showNext(){
  if(queue.length===0){showing=false;return;}
  showing = true;
  const t = document.createElement('div');
  t.className = 'item';
  t.textContent = queue.shift();
  toastBox.appendChild(t);
  setTimeout(()=>{
    t.style.opacity='0'; t.style.transform='translateY(6px)';
    setTimeout(()=>{ t.remove(); showNext(); }, 180);
  }, 2500);
}

/* =========================
   Reset com dropdown (separado)
   ========================= */
const btnReset = document.getElementById('btnReset');
const resetMenu = document.getElementById('resetMenu');
btnReset.addEventListener('click', (e)=>{
  const r = e.currentTarget.getBoundingClientRect();
  resetMenu.style.left = (r.left - 120 + r.width/2) + 'px';
  resetMenu.style.top = (r.bottom + 8) + 'px';
  resetMenu.classList.toggle('show');
});
document.getElementById('resetTreinos').addEventListener('click', ()=>{
  resetMenu.classList.remove('show');
  document.querySelectorAll('.card').forEach(c=> c.classList.remove('completed'));
  saveProgress();
  document.querySelectorAll('.section').forEach((s,si)=> updateCounter(si));
  toast('Treinos resetados');
});
document.getElementById('resetResumo').addEventListener('click', ()=>{
  resetMenu.classList.remove('show');
  localStorage.removeItem('weekLogs');
  toast('Resumo da semana resetado');
});
document.getElementById('resetCalendario').addEventListener('click', ()=>{
  resetMenu.classList.remove('show');
  localStorage.removeItem('calendarLogs');
  toast('Calendário resetado');
});
window.addEventListener('click', (ev)=>{
  if(!resetMenu.contains(ev.target) && ev.target!==btnReset){ resetMenu.classList.remove('show'); }
});
window.addEventListener('scroll', ()=> resetMenu.classList.remove('show'));

/* =========================
   Vibração 5s + Som final estilo iPhone (clean)
   ========================= */
function vibrate5(){ if('vibrate' in navigator){ navigator.vibrate([80,40,80]); } }
function playEndTone(){
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  const o = ctx.createOscillator();
  const g = ctx.createGain();
  o.type='sine';
  o.frequency.value = 880; // A5
  o.connect(g); g.connect(ctx.destination);
  const now = ctx.currentTime;
  g.gain.setValueAtTime(0, now);
  g.gain.linearRampToValueAtTime(0.15, now+0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, now+0.25);
  o.start(); o.stop(now+0.26);
}

/* =========================
   Util – Atualiza contadores ao entrar
   ========================= */
document.querySelectorAll('.section').forEach((s,si)=> updateCounter(si));

/* =========================
   Resumo da Semana (usa weekLogs separado)
   ========================= */
const iconSummary = document.getElementById('iconSummary');
const overlaySummary = document.getElementById('overlaySummary');
const closeSummary = document.getElementById('closeSummary');
const weekDots = document.getElementById('weekDots');
const weekInfo = document.getElementById('weekInfo');
const weekProgress = document.getElementById('weekProgress');

// Inicializar labels
const dayLabels = ['Seg','Ter','Qua','Qui','Sex','Sab','Dom'];
if(weekDots.children.length===0){
  dayLabels.forEach(()=>{
    const dot=document.createElement('div');
    dot.textContent='';
    weekDots.appendChild(dot);
  });
}
function getWeekKey(date=new Date()){
  const y = date.getFullYear();
  const jan1 = new Date(y,0,1);
  const past = (date - jan1) / 86400000 + jan1.getDay()+1;
  const w = Math.ceil(past/7);
  return y+'-W'+w;
}
function updateSummary(){
  const today=new Date();
  const weekKey=getWeekKey(today);
  const logs = JSON.parse(localStorage.getItem('weekLogs')||'{}');
  const data = logs[weekKey]||{days:[],total:0};
  [...weekDots.children].forEach((dot,i)=>{
    dot.classList.toggle('active', data.days.includes(i));
  });
  weekInfo.textContent=`Treinou ${data.days.length} dia(s) | ${data.total} exercícios concluídos`;
  const pct=Math.min(100,(data.days.length/5)*100);
  weekProgress.style.width=pct+'%';
}
iconSummary.addEventListener('click',()=>{overlaySummary.classList.add('show');updateSummary();});
closeSummary.addEventListener('click',()=>overlaySummary.classList.remove('show'));

/* =========================
   Calendário Mensal (usa calendarLogs separado)
   ========================= */
const iconCalendar=document.getElementById('iconExtra');
const overlayCalendar=document.getElementById('overlayCalendar');
const closeCalendar=document.getElementById('closeCalendar');
const calTitle=document.getElementById('calTitle');
const calGrid=document.getElementById('calGrid');
const prevMonth=document.getElementById('prevMonth');
const nextMonth=document.getElementById('nextMonth');

let currentMonth=new Date();
function renderCalendar(date){
  calGrid.innerHTML='';
  const year=date.getFullYear();
  const month=date.getMonth();
  const firstDay=new Date(year,month,1).getDay(); //0=Dom
  const lastDate=new Date(year,month+1,0).getDate();
  const monthNames=['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
  calTitle.textContent=`${monthNames[month]} ${year}`;
  const days=['Seg','Ter','Qua','Qui','Sex','Sab','Dom'];
  days.forEach(d=>{
    const l=document.createElement('div');
    l.textContent=d; l.className='label';
    calGrid.appendChild(l);
  });
  const start=(firstDay===0?6:firstDay-1);
  for(let i=0;i<start;i++){
    const empty=document.createElement('div'); empty.textContent=''; calGrid.appendChild(empty);
  }
  const entries=JSON.parse(localStorage.getItem('calendarLogs')||'[]');
  for(let d=1;d<=lastDate;d++){
    const cell=document.createElement('div');
    cell.textContent=d;
    const iso=`${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    if(entries.includes(iso)) cell.classList.add('active');
    calGrid.appendChild(cell);
  }
}
iconCalendar.addEventListener('click',()=>{overlayCalendar.classList.add('show');renderCalendar(currentMonth);});
closeCalendar.addEventListener('click',()=>overlayCalendar.classList.remove('show'));
prevMonth.addEventListener('click',()=>{currentMonth=new Date(currentMonth.getFullYear(),currentMonth.getMonth()-1,1);renderCalendar(currentMonth);});
nextMonth.addEventListener('click',()=>{currentMonth=new Date(currentMonth.getFullYear(),currentMonth.getMonth()+1,1);renderCalendar(currentMonth);});

</script>
</body>
</html>
