<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PERSONAL — Soft UI Preview</title>
  <style>
    /* --------------------
       Design Tokens
    -------------------- */
    :root{
      --bg: #f6f8fb;
      --text: #1b1f2a;
      --muted:#667085;
      --glass: rgba(255,255,255,0.55);
      --glass-strong: rgba(255,255,255,0.7);
      --card: rgba(255,255,255,0.65);
      --accent: #7b6cff; /* lilás suave */
      --accent-2:#5ec2ff; /* azul suave */
      --accent-3:#ff7bcf; /* rosa suave */
      --success:#30d7a9;
      --danger:#ff6b6b;
      --radius: 18px;
      --shadow: 0 10px 30px rgba(24,39,75,.08), 0 1px 2px rgba(0,0,0,.04);
    }
    body.dark{
      --bg: #0f1220;
      --text: #f3f5f7;
      --muted:#98a2b3;
      --glass: rgba(18,19,34,0.55);
      --glass-strong: rgba(18,19,34,0.7);
      --card: rgba(24,27,48,0.6);
      --accent: #9a8cff;
      --accent-2:#7dd3fc;
      --accent-3:#f472b6;
      --shadow: 0 10px 30px rgba(0,0,0,.35), 0 1px 2px rgba(0,0,0,.25);
    }

    /* Reset */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color: var(--text);
      overflow-x:hidden;
      transition: background .3s ease, color .3s ease;
    }

    /* --------------------
       BACKGROUND: Aquarela + Bolhas
    -------------------- */
    .bg-wrap{
      position:fixed; inset:0; z-index:-1; overflow:hidden; pointer-events:none;
      filter: saturate(120%);
    }
    .aurora{
      position:absolute; inset:-20%;
      background:
        radial-gradient(60% 50% at 20% 30%, rgba(123,108,255,.25), transparent 60%),
        radial-gradient(50% 45% at 80% 20%, rgba(94,194,255,.25), transparent 60%),
        radial-gradient(40% 40% at 40% 80%, rgba(255,123,207,.22), transparent 60%);
      animation: auroraMove 18s ease-in-out infinite alternate;
      filter: blur(30px);
    }
    @keyframes auroraMove{ from{transform: translateY(-2%) scale(1)} to{transform: translateY(2%) scale(1.05)} }

    .bubble{ position:absolute; border-radius:50%; background: linear-gradient(145deg, rgba(255,255,255,.6), rgba(255,255,255,.3)); box-shadow: inset 0 1px 6px rgba(255,255,255,.6), inset 0 -4px 12px rgba(0,0,0,.08); backdrop-filter: blur(10px); }
    .bubble:nth-child(1){ width:160px; height:160px; left:6%; bottom:-40px; animation: float 16s ease-in-out infinite; }
    .bubble:nth-child(2){ width:120px; height:120px; left:70%; top:10%; animation: float 14s 1s ease-in-out infinite; }
    .bubble:nth-child(3){ width:220px; height:220px; right:-60px; top:40%; animation: float 20s .5s ease-in-out infinite; }
    .bubble:nth-child(4){ width:90px; height:90px; left:40%; bottom:10%; animation: float 18s 2s ease-in-out infinite; }
    @keyframes float{ 0%{ transform: translateY(0) } 50%{ transform: translateY(-18px) } 100%{ transform: translateY(0) } }

    /* Parallax leve */
    .parallax{ transform: translateZ(0); will-change: transform; }

    /* --------------------
       HEADER
    -------------------- */
    header{
      position:sticky; top:12px; margin:12px; padding:12px 16px;
      display:flex; align-items:center; gap:12px; justify-content:space-between;
      background: var(--glass);
      backdrop-filter: blur(14px) saturate(160%);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .brand{ display:flex; align-items:center; gap:10px; font-weight:700; }
    .avatar{
      width:42px; height:42px; border-radius:50%; overflow:hidden; border:2px solid rgba(255,255,255,.6);
      background: linear-gradient(145deg, rgba(255,255,255,.6), rgba(255,255,255,.2));
    }
    .avatar img{ width:100%; height:100%; object-fit:cover; display:block; }

    .actions{ display:flex; align-items:center; gap:8px; }
    .bubble-btn{ position:relative; padding:10px; border-radius:14px; background: var(--glass);
      backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,.4); cursor:pointer; box-shadow: var(--shadow);
      transition: transform .15s ease, box-shadow .2s ease; display:inline-flex; align-items:center; justify-content:center; }
    .bubble-btn:hover{ transform: translateY(-2px); }
    .bubble-btn:active{ transform: translateY(0); }
    .bubble-btn svg{ width:20px; height:20px; }
    .ripple{ position:absolute; border-radius:50%; transform: scale(0); opacity:.5; background: radial-gradient(circle, rgba(255,255,255,.9), rgba(255,255,255,0)); animation: ripple .6s ease-out forwards; }
    @keyframes ripple{ to{ transform: scale(8); opacity:0 } }

    /* --------------------
       DASHBOARD MINI
    -------------------- */
    .dash{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:12px; padding:12px; margin:0 12px; }
    .stat{ background: var(--glass); backdrop-filter: blur(12px); border-radius: var(--radius); padding:12px; box-shadow: var(--shadow); display:flex; align-items:center; gap:12px; }
    .progress-circle{ width:36px; height:36px; }
    .stat h4{ font-size:.9rem; font-weight:700; }
    .stat small{ color: var(--muted); display:block; margin-top:2px; }

    /* sparkline */
    .spark{ width:100%; height:36px; }

    /* --------------------
       SEÇÕES & CARDS
    -------------------- */
    .container{ max-width:980px; margin: 4px auto 24px; padding: 0 12px; }

    .section{
      margin:14px 0; border-radius: var(--radius); overflow:hidden; background: var(--glass);
      backdrop-filter: blur(12px); box-shadow: var(--shadow);
      border:1px solid rgba(255,255,255,.5);
    }
    .section-header{ display:flex; align-items:center; justify-content:space-between; padding:14px 16px; cursor:pointer; user-select:none; }
    .section-title{ display:flex; align-items:center; gap:10px; font-weight:800; }
    .badge{ padding:4px 8px; border-radius:999px; background: linear-gradient(90deg, var(--accent), var(--accent-2)); color:white; font-size:.7rem; font-weight:700; }

    .toggle{ width:24px; height:24px; display:grid; place-items:center; border-radius:10px; background: var(--glass-strong); border:1px solid rgba(255,255,255,.55); transition: transform .25s ease; }
    .toggle svg{ transition: transform .25s ease; }
    .toggle.open svg{ transform: rotate(180deg); }

    .section-body{ max-height:0; overflow:hidden; transition: max-height .5s ease, opacity .3s ease; opacity:0; padding: 0 12px; }
    .section.open .section-body{ opacity:1; padding: 10px 12px 14px; }

    .grid{ display:grid; grid-template-columns: 1fr; gap:12px; }
    @media (min-width: 720px){ .grid{ grid-template-columns: 1fr 1fr; } }

    .card{
      position:relative; background: var(--card); border-radius: 16px; padding: 12px; box-shadow: var(--shadow); overflow:hidden; transition: transform .2s ease, box-shadow .2s ease;
    }
    .card:hover{ transform: translateY(-3px); box-shadow: 0 12px 30px rgba(123,108,255,.12), 0 2px 8px rgba(0,0,0,.05); }
    .card h5{ font-size: .95rem; margin-bottom: 6px; }
    .meta{ color: var(--muted); font-size:.82rem; }
    video{ width:100%; border-radius:12px; margin-top:8px; }

    .row{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-top:10px; }
    .pill{ padding:6px 10px; border-radius:999px; background: rgba(0,0,0,.06); color: var(--muted); font-size:.78rem; }
    body.dark .pill{ background: rgba(255,255,255,.06); }

    .btn{ border:none; outline:none; padding:10px 14px; border-radius:12px; background: linear-gradient(135deg, var(--accent), var(--accent-2)); color:white; font-weight:700; cursor:pointer; position:relative; overflow:hidden; }
    .btn.secondary{ background: linear-gradient(135deg, #c7cbd6, #adb5c2); color:#1b2030; }

    .check{ position:absolute; top:10px; right:10px; width:22px; height:22px; border-radius:8px; background: var(--glass); border:1px solid rgba(255,255,255,.6); display:grid; place-items:center; cursor:pointer; transition: all .2s ease; }
    .check svg{ width:14px; height:14px; opacity:.35; }
    .card.done{ outline:2px solid var(--success); box-shadow: 0 0 0 4px rgba(48,215,169,.12); }
    .card.done .check{ background: linear-gradient(135deg, #2ee5b3, #19c795); }
    .card.done .check svg{ opacity:1; fill:#fff; }

    /* Popup Toast */
    .toast{ position:fixed; left:50%; transform: translateX(-50%); bottom:18px; background: var(--glass-strong); backdrop-filter: blur(12px); padding:10px 14px; border-radius:12px; box-shadow: var(--shadow); display:none; }

    /* Modal Upload (drag & drop) */
    .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,.25); }
    .modal-inner{ width:min(560px,92vw); background: var(--glass); backdrop-filter: blur(14px); border-radius: 18px; padding:16px; box-shadow: var(--shadow); }
    .drop{ border:2px dashed rgba(0,0,0,.2); border-radius:16px; padding:22px; text-align:center; color:var(--muted); }
    body.dark .drop{ border-color: rgba(255,255,255,.25); }

    /* Ranking simples */
    .rank{ display:flex; gap:10px; align-items:center; }
    .medal{ width:28px; height:28px; border-radius:50%; display:grid; place-items:center; color:#fff; font-weight:900; }
    .m1{ background: linear-gradient(135deg,#f59e0b,#fbbf24); }
    .m2{ background: linear-gradient(135deg,#9ca3af,#d1d5db); }
    .m3{ background: linear-gradient(135deg,#b45309,#d97706); }

    footer{ text-align:center; color:var(--muted); font-size:.8rem; padding:24px 0; }
  </style>
</head>
<body>
  <!-- BACKGROUND LAYERS -->
  <div class="bg-wrap">
    <div class="aurora parallax"></div>
    <div class="bubble parallax"></div>
    <div class="bubble parallax"></div>
    <div class="bubble parallax"></div>
    <div class="bubble parallax"></div>
  </div>

  <!-- HEADER -->
  <header>
    <div class="brand">
      <div class="avatar"><img id="avatarImg" src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=200&auto=format&fit=crop" alt="avatar"/></div>
      <span>PERSONAL</span>
    </div>
    <div class="actions">
      <button class="bubble-btn" id="uploadBtn" title="Enviar foto (drag & drop)">
        <!-- Camera Icon -->
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
      </button>
      <button class="bubble-btn" id="resetBtn" title="Resetar concluídos">
        <!-- Reset Icon -->
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>
      </button>
      <button class="bubble-btn" id="focusBtn" title="Modo foco">
        <!-- Headphones Icon -->
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 18v-6a9 9 0 0 1 18 0v6"/><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3"/><path d="M3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3"/></svg>
      </button>
      <button class="bubble-btn" id="themeBtn" title="Tema claro/escuro">
        <!-- Sun/Moon Icon -->
        <svg id="themeIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2m10-10h-2M4 12H2m15.54 6.46-1.42-1.42M7.88 7.88 6.46 6.46m10 0 1.42-1.42M7.88 16.12 6.46 17.54"/></svg>
      </button>
    </div>
  </header>

  <!-- DASH MINI -->
  <section class="dash">
    <div class="stat">
      <svg class="progress-circle" viewBox="0 0 36 36">
        <path d="M18 2 a 16 16 0 1 1 0 32 a 16 16 0 1 1 0 -32" stroke="#e6e9ef" stroke-width="4" fill="none"/>
        <path id="progPath" d="M18 2 a 16 16 0 1 1 0 32 a 16 16 0 1 1 0 -32" stroke="url(#grad)" stroke-width="4" fill="none" stroke-dasharray="100" stroke-dashoffset="100"/>
        <defs><linearGradient id="grad" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="var(--accent)"/><stop offset="100%" stop-color="var(--accent-2)"/></linearGradient></defs>
      </svg>
      <div>
        <h4><span id="doneCount">0</span> concluídos</h4>
        <small>Esta semana</small>
      </div>
    </div>
    <div class="stat">
      <svg class="spark" viewBox="0 0 120 36"><polyline id="sparkline" fill="none" stroke="url(#grad)" stroke-width="2" points="0,26 15,22 30,28 45,18 60,20 75,12 90,16 105,10 120,14"/></svg>
      <div>
        <h4>Progresso</h4>
        <small>Últimos 9 treinos</small>
      </div>
    </div>
    <div class="stat rank">
      <div class="medal m1">1</div>
      <div>
        <h4>Ranking pessoal</h4>
        <small>Você superou sua média!</small>
      </div>
    </div>
  </section>

  <main class="container">
    <!-- SEÇÃO 1 -->
    <section class="section" data-color="var(--accent)">
      <div class="section-header" onclick="toggleSection(this)">
        <div class="section-title">
          <span class="badge">Quadríceps</span>
          <span>Treino de Quadríceps</span>
        </div>
        <div class="toggle" aria-label="alternar">
          <svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
      </div>
      <div class="section-body">
        <div class="grid">
          <!-- Card exemplo 1 -->
          <article class="card" data-id="q1">
            <div class="check" onclick="toggleDone(event,this)" title="Concluir">
              <svg viewBox="0 0 24 24"><path d="M20 6 9 17l-5-5"/></svg>
            </div>
            <h5>Agachamento Sumô com Halteres</h5>
            <div class="meta">Séries: 3x10/10/10 Drop • Carga: 0kg • Intervalo: 60s</div>
            <video src="https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-sumo-squat-front.mp4" controls playsinline></video>
            <div class="row">
              <span class="pill">Duração ~ 2-3min</span>
              <button class="btn" onclick="startPomodoro(event,60)">Pomodoro 60s</button>
            </div>
          </article>

          <!-- Card exemplo 2 -->
          <article class="card" data-id="q2">
            <div class="check" onclick="toggleDone(event,this)" title="Concluir">
              <svg viewBox="0 0 24 24"><path d="M20 6 9 17l-5-5"/></svg>
            </div>
            <h5>Leg Press 45</h5>
            <div class="meta">Séries: 4x15 + 15 pés afastados • Carga: 12kg • Intervalo: 40s</div>
            <video src="https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-leg-press-front.mp4" controls playsinline></video>
            <div class="row">
              <span class="pill">Foco: Quadríceps</span>
              <button class="btn secondary" onclick="pip(event)">PiP</button>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- SEÇÃO 2 -->
    <section class="section" data-color="var(--accent-2)">
      <div class="section-header" onclick="toggleSection(this)">
        <div class="section-title">
          <span class="badge" style="background: linear-gradient(90deg, var(--accent-2), var(--accent-3));">Posterior & Glúteo</span>
          <span>Posterior & Glúteo</span>
        </div>
        <div class="toggle" aria-label="alternar">
          <svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
      </div>
      <div class="section-body">
        <div class="grid">
          <article class="card" data-id="pg1">
            <div class="check" onclick="toggleDone(event,this)"><svg viewBox="0 0 24 24"><path d="M20 6 9 17l-5-5"/></svg></div>
            <h5>Agachamento com Halteres</h5>
            <div class="meta">Séries: 3x10+10+10 Drop • Intervalo: 60s</div>
            <video src="https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-front-rack-squat-side.mp4" controls playsinline></video>
            <div class="row"><span class="pill">Glúteo + Posterior</span><button class="btn" onclick="startPomodoro(event,60)">Pomodoro 60s</button></div>
          </article>
        </div>
      </div>
    </section>

    <!-- SEÇÃO 3 -->
    <section class="section" data-color="var(--accent-3)">
      <div class="section-header" onclick="toggleSection(this)">
        <div class="section-title">
          <span class="badge" style="background: linear-gradient(90deg, var(--accent-3), var(--accent));">Peito, Tríceps & Bíceps</span>
          <span>Peito, Tríceps & Bíceps</span>
        </div>
        <div class="toggle" aria-label="alternar">
          <svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
      </div>
      <div class="section-body">
        <div class="grid">
          <article class="card" data-id="ptb1">
            <div class="check" onclick="toggleDone(event,this)"><svg viewBox="0 0 24 24"><path d="M20 6 9 17l-5-5"/></svg></div>
            <h5>Crucifixo com Halteres</h5>
            <div class="meta">Séries: 4x12 • Intervalo: 30s</div>
            <video src="https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-incline-chest-fly-front.mp4" controls playsinline></video>
            <div class="row"><span class="pill">Peitoral</span><button class="btn secondary" onclick="pip(event)">PiP</button></div>
          </article>
        </div>
      </div>
    </section>

    <!-- SEÇÃO 4 -->
    <section class="section" data-color="var(--accent)">
      <div class="section-header" onclick="toggleSection(this)">
        <div class="section-title">
          <span class="badge">Ombro & Costas</span>
          <span>Ombro & Costas</span>
        </div>
        <div class="toggle" aria-label="alternar">
          <svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </div>
      </div>
      <div class="section-body">
        <div class="grid">
          <article class="card" data-id="oc1">
            <div class="check" onclick="toggleDone(event,this)"><svg viewBox="0 0 24 24"><path d="M20 6 9 17l-5-5"/></svg></div>
            <h5>Desenvolvimento com Halteres</h5>
            <div class="meta">Séries: 3x10/8/6 Drop • Intervalo: 30s</div>
            <video src="https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-neutral-overhead-press-side.mp4" controls playsinline></video>
            <div class="row"><span class="pill">Ombros</span><button class="btn" onclick="startPomodoro(event,30)">Pomodoro 30s</button></div>
          </article>
        </div>
      </div>
    </section>

    <!-- TOAST -->
    <div id="toast" class="toast">✔️ Progresso resetado com sucesso</div>
  </main>

  <!-- MODAL UPLOAD -->
  <div id="uploadModal" class="modal" aria-hidden="true">
    <div class="modal-inner">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
        <h3 style="font-size:1rem;">Enviar foto</h3>
        <button class="bubble-btn" onclick="closeUpload()" aria-label="Fechar">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18M6 6l12 12"/></svg>
        </button>
      </div>
      <form id="uploadForm" action="https://formspree.io/f/mzzavnrq" method="POST" enctype="multipart/form-data">
        <div id="drop" class="drop">
          Arraste e solte a imagem aqui ou <strong>clique para selecionar</strong>
          <input type="file" name="foto" accept="image/*" style="display:none;" />
        </div>
        <div id="preview" style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;"></div>
        <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:12px;">
          <button type="button" class="btn secondary" onclick="closeUpload()">Cancelar</button>
          <button type="submit" class="btn">Enviar</button>
        </div>
      </form>
    </div>
  </div>

  <footer>© 2025 PERSONAL — Soft UI Preview</footer>

  <script>
    // ---------------------- Helpers
    const qs = (s,el=document)=> el.querySelector(s);
    const qsa = (s,el=document)=> [...el.querySelectorAll(s)];

    // Default theme = light
    (function(){
      const saved = localStorage.getItem('theme');
      if(saved==='dark') document.body.classList.add('dark');
    })();

    // Theme toggle
    qs('#themeBtn').addEventListener('click', e=>{
      document.body.classList.toggle('dark');
      localStorage.setItem('theme', document.body.classList.contains('dark')? 'dark':'light');
      ripple(e.currentTarget, e);
    });

    // Ripple effect for bubble buttons
    function ripple(btn, e){
      const r = document.createElement('span');
      r.className='ripple';
      const rect = btn.getBoundingClientRect();
      const x = e.clientX - rect.left; const y = e.clientY - rect.top;
      r.style.left = x+'px'; r.style.top = y+'px'; r.style.width=r.style.height=Math.max(rect.width,rect.height)+'px';
      btn.appendChild(r); setTimeout(()=>r.remove(), 650);
    }

    // Parallax light
    window.addEventListener('scroll', ()=>{
      const y = window.scrollY;
      qsa('.parallax').forEach((el,i)=>{
        const speed = (i+1)*0.06;
        el.style.transform = `translateY(${y*speed}px)`;
      });
    });

    // Accordion sections
    function toggleSection(header){
      const section = header.closest('.section');
      const body = section.querySelector('.section-body');
      const icon = header.querySelector('.toggle');
      const open = section.classList.toggle('open');
      if(open){
        icon.classList.add('open');
        body.style.maxHeight = body.scrollHeight + 'px';
      } else {
        icon.classList.remove('open');
        body.style.maxHeight = 0;
      }
    }

    // Mark done + confetti particles
    function toggleDone(ev, el){
      ev.stopPropagation();
      const card = el.closest('.card');
      card.classList.toggle('done');
      if(card.classList.contains('done')){
        spawnParticles(card);
        updateDoneCount(1);
      } else {
        updateDoneCount(-1);
      }
    }

    function spawnParticles(target){
      for(let i=0;i<12;i++){
        const p=document.createElement('span');
        const s=6+Math.random()*8; const a= (Math.random()*360)|0; const d = 600+Math.random()*400;
        p.style.cssText = `position:absolute; width:${s}px; height:${s}px; border-radius:50%; background: radial-gradient(circle, #fff, transparent); left:50%; top:20px; transform: translate(-50%,-50%); pointer-events:none;`;
        target.appendChild(p);
        p.animate([
          { transform:`translate(-50%,-50%) rotate(${a}deg)`, opacity:1 },
          { transform:`translate(calc(-50% + ${Math.cos(a)*60}px), calc(-50% + ${Math.sin(a)*60}px))`, opacity:0 }
        ], { duration:d, easing:'ease-out' }).onfinish=()=>p.remove();
      }
    }

    // Done counter + progress ring animation
    function updateDoneCount(delta){
      const el = qs('#doneCount');
      let val = parseInt(el.textContent,10)+delta; if(val<0) val=0; el.textContent = val;
      // 10 as goal for animation scale
      const pct = Math.min(100, (val/10)*100);
      const path = qs('#progPath');
      path.style.strokeDashoffset = (100 - pct);
    }

    // Reset progress
    qs('#resetBtn').addEventListener('click', e=>{
      ripple(e.currentTarget, e);
      qsa('.card.done').forEach(c=>c.classList.remove('done'));
      qs('#doneCount').textContent='0';
      qs('#progPath').style.strokeDashoffset=100;
      showToast('✔️ Progresso resetado com sucesso');
    });

    // Toast
    function showToast(msg){
      const t = qs('#toast');
      t.textContent = msg; t.style.display='block';
      setTimeout(()=>{ t.style.display='none'; }, 1800);
    }

    // Upload modal + drag & drop (Formspree)
    const modal = qs('#uploadModal');
    const drop = qs('#drop');
    const input = drop.querySelector('input');
    qs('#uploadBtn').addEventListener('click', e=>{ ripple(e.currentTarget, e); openUpload(); });
    function openUpload(){ modal.style.display='flex'; modal.setAttribute('aria-hidden','false'); }
    function closeUpload(){ modal.style.display='none'; modal.setAttribute('aria-hidden','true'); }

    drop.addEventListener('click',()=> input.click());
    drop.addEventListener('dragover', e=>{ e.preventDefault(); drop.style.borderColor='var(--accent)'; });
    drop.addEventListener('dragleave', ()=> drop.style.borderColor='');
    drop.addEventListener('drop', e=>{ e.preventDefault(); input.files = e.dataTransfer.files; renderPreview(); drop.style.borderColor=''; });
    input.addEventListener('change', renderPreview);

    function renderPreview(){
      const pv = qs('#preview'); pv.innerHTML='';
      [...input.files].slice(0,4).forEach(file=>{
        const url = URL.createObjectURL(file);
        const img = new Image(); img.src=url; img.style.cssText='width:86px;height:86px;object-fit:cover;border-radius:12px;box-shadow:var(--shadow)';
        pv.appendChild(img);
      });
    }

    qs('#uploadForm').addEventListener('submit', async (e)=>{
      e.preventDefault();
      const fd = new FormData(e.currentTarget);
      try{
        const r = await fetch(e.currentTarget.action,{ method:'POST', body: fd, headers:{ 'Accept':'application/json' }});
        if(r.ok){ showToast('📤 Foto enviada!'); closeUpload(); }
        else{ showToast('⚠️ Falha ao enviar'); }
      }catch(err){ showToast('⚠️ Erro de rede'); }
    });

    // Focus Mode (demo)
    qs('#focusBtn').addEventListener('click', e=>{ ripple(e.currentTarget, e); showToast('🎧 Modo foco ativo'); });

    // Picture-in-Picture helper
    async function pip(ev){
      ev.stopPropagation();
      const card = ev.currentTarget.closest('.card');
      const v = card.querySelector('video');
      try{
        if(document.pictureInPictureElement) await document.exitPictureInPicture();
        await v.requestPictureInPicture();
      }catch(err){ showToast('ℹ️ PiP não disponível'); }
    }

    // Pomodoro visual simples
    function startPomodoro(ev, seconds){
      ev.stopPropagation();
      const btn = ev.currentTarget;
      btn.disabled = true; btn.textContent = `Descanso ${seconds}s`;
      const start = Date.now();
      const iv = setInterval(()=>{
        const elapsed = Math.floor((Date.now()-start)/1000);
        const left = Math.max(0, seconds - elapsed);
        btn.textContent = `Descanso ${left}s`;
        if(left<=0){ clearInterval(iv); btn.disabled=false; btn.textContent='Pronto ✔️'; showToast('Intervalo concluído'); }
      }, 1000);
    }

    // Open sections collapsed by default (no JS needed initial)
    qsa('.section').forEach(s=>{ s.classList.remove('open'); s.querySelector('.section-body').style.maxHeight = 0; });

    // Button ripples
    qsa('.bubble-btn,.btn').forEach(b=> b.addEventListener('click', (e)=> ripple(b,e)));
  </script>
</body>
</html>
