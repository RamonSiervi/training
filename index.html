<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MFit — Light Glass v4</title>
  <style>
    /* ===================
       PALETA (apenas LIGHT)
       =================== */
    :root{
      --bg: 0 0% 100%;
      --bg-acc-1: 226 91% 60% / .07;
      --bg-acc-2: 280 83% 68% / .07;
      --t: 230 15% 18%;
      --muted: 230 10% 40%;
      --glass: 0 0% 100% / .55;
      --glass-strong: 0 0% 100% / .75;
      --stroke: 230 15% 10% / .06;
      --ring: 226 91% 60%;
      --ring-2: 280 83% 68%;
      --accent: 220 88% 60%;
      --success: 148 60% 44%;
      --danger: 2 89% 62%;
      --media-h: 108px; /* ~+20% vs 90px (compacto e confortável) */
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:hsl(var(--t)); background:hsl(var(--bg));
      background-image: radial-gradient(1200px 600px at -10% -10%, hsl(var(--bg-acc-1)), transparent),
                        radial-gradient(1000px 500px at 110% 0%, hsl(var(--bg-acc-2)), transparent);
      -webkit-font-smoothing:antialiased; line-height:1.25;
    }

    /* ===================
       TOPO
       =================== */
    .top{ position:sticky; top:0; z-index:40; margin:12px; padding:10px 12px;
      display:flex; align-items:center; justify-content:space-between; gap:8px;
      border-radius:18px; backdrop-filter: blur(16px) saturate(140%);
      -webkit-backdrop-filter: blur(16px) saturate(140%);
      background:linear-gradient(to bottom right, hsl(var(--glass)), hsl(var(--glass-strong)));
      border:1px solid hsl(var(--stroke));
      box-shadow: 0 8px 26px hsl(220 40% 2%/.15);
    }
    .left, .right{display:flex; align-items:center; gap:10px}
    .brand{width:30px;height:30px;border-radius:999px;background:radial-gradient(circle at 25% 20%, hsl(var(--ring)), hsl(var(--ring-2))); box-shadow: inset 0 1px 0 #fff7, 0 4px 10px #0002}
    .nav a{font-weight:900; padding:6px 10px; border-radius:12px; color:hsl(var(--t)); text-decoration:none; cursor:pointer; position:relative; display:inline-block}
    /* Efeito do título "Dieta" – brilho/gradiente suave like ref */
    .nav a#dietLink{
      --g: linear-gradient(90deg, hsl(var(--ring)), hsl(var(--ring-2)));
      background: var(--g);
      -webkit-background-clip:text; background-clip:text; color:transparent;
      filter: drop-shadow(0 1px 0 #fff6);
    }
    .nav a#dietLink::after{
      content:""; position:absolute; left:0; right:0; bottom:-2px; height:3px;
      background: linear-gradient(90deg, hsl(var(--ring)), transparent, hsl(var(--ring-2)));
      border-radius:3px; filter:blur(.3px); opacity:.85;
      animation: dietWipe 5s linear infinite;
      background-size: 200% 100%;
    }
    @keyframes dietWipe{ 0%{background-position:0% 0} 100%{background-position:200% 0} }

    .icon{
      width:40px;height:40px;border-radius:12px;display:grid;place-items:center; cursor:pointer;
      border:1px solid hsl(var(--stroke)); background:linear-gradient(145deg, hsl(var(--glass)), hsl(var(--glass-strong)));
      box-shadow: inset 0 1px 0 #fff6, 0 6px 16px #0001; transition:transform .2s;
    }
    .icon:active{transform:scale(.96)}
    .icon svg{width:22px;height:22px;opacity:.9}

    main{padding:6px 12px 140px; display:grid; gap:12px}

    /* ===================
       SEÇÕES
       =================== */
    .section{border:1px solid hsl(var(--stroke)); border-radius:18px; overflow:hidden; box-shadow:0 10px 26px #0001}
    .section-header{
      display:flex; align-items:center; justify-content:space-between; padding:14px; cursor:pointer; user-select:none;
      background:linear-gradient(135deg, hsl(var(--ring)/.10), hsl(0 0% 100%/.6));
      backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
      border-bottom:1px solid hsl(var(--stroke));
    }
    .section-header .title{font-weight:800}
    .section-header .plus{width:36px;height:36px;border-radius:10px;display:grid;place-items:center;background:hsl(var(--glass)); border:1px solid hsl(var(--stroke)); transition:.25s}
    .section-header .plus.open{transform:rotate(90deg)}
    .underline{height:3px; background:linear-gradient(90deg, hsl(var(--ring)), hsl(var(--ring-2)));}

    .panel{display:none; padding:12px; background:linear-gradient(180deg, hsl(0 0% 100%/.6), hsl(0 0% 100%/.3))}
    .panel.open{display:grid; gap:12px}
    .fx-fade{animation:fade .35s ease both}
    @keyframes fade{from{opacity:0; transform:translateY(-6px)} to{opacity:1; transform:none}}

    /* ===================
       CARD
       =================== */
    .card{ display:grid; grid-template-columns: 1fr 148px; gap:12px; align-items:center;
      background:hsl(0 0% 100% / .7); border:1px solid hsl(var(--stroke));
      border-radius:16px; padding:12px; backdrop-filter: blur(10px);
      box-shadow:0 6px 14px #0001; position:relative; transition:.35s }
    .card:hover{box-shadow:0 8px 18px #0002}
    .title-sm{font-weight:800}
    .meta{font-size:12px; color:hsl(var(--muted))}

    /* ===== Efeito de conclusão em cascata (fundo transparência) */
    .card.done{outline:2px solid hsl(var(--success)/.35); background: hsl(0 0% 100%/.35)}
    .card.done::after{content:""; position:absolute; inset:0; background:radial-gradient(180px 180px at 20% 20%, hsl(var(--success)/.10), transparent 60%); pointer-events:none; animation: ripple .6s ease}
    @keyframes ripple{from{opacity:0; transform:scale(.96)} to{opacity:1; transform:none}}

    /* ===================
       MÍDIA (thumb + vídeo inline)
       =================== */
    .media{position:relative}
    .thumb{position:relative; width:100%; height:var(--media-h); border-radius:12px; background:linear-gradient(135deg, #e8eefc, #f2e9fb); border:1px solid hsl(var(--stroke)); overflow:hidden}
    .play{position:absolute; inset:0; display:grid; place-items:center; transition:opacity .25s ease}
    .play button{width:48px;height:48px;border-radius:999px;border:1px solid hsl(var(--stroke)); background:linear-gradient(145deg, hsl(var(--glass)), hsl(var(--glass-strong))); box-shadow:inset 0 1px 0 #fff6, 0 6px 14px #0002; cursor:pointer}
    .vid{display:none}
    .vid video{width:100%; height:var(--media-h); border-radius:12px; border:1px solid hsl(var(--stroke)); object-fit:cover; display:block}
    .vid .back{position:absolute; top:6px; right:6px; width:28px; height:28px; border-radius:10px; border:1px solid hsl(var(--stroke)); background:hsl(var(--glass)); display:grid; place-items:center; cursor:pointer}
    /* toque pra play/pause com feedback sutil */
    .tapFX{position:absolute; inset:0; display:none; place-items:center; pointer-events:none}
    .tapFX.show{display:grid; animation: tap .4s ease}
    .tapFX .dot{width:54px;height:54px;border-radius:999px; border:2px solid #fff; background:#0003; display:grid;place-items:center; font-size:18px; color:#fff}
    @keyframes tap{ from{opacity:0; transform:scale(.78)} to{opacity:1; transform:none} }

    /* ===================
       AÇÕES
       =================== */
    .actions{display:flex; gap:8px; align-items:center; margin-top:6px}
    .chip{padding:6px 10px; border-radius:999px; border:1px solid hsl(var(--stroke)); background:linear-gradient(145deg, hsl(var(--glass)), hsl(var(--glass-strong))); font-size:12px; font-weight:700; cursor:pointer}
    .chip.thin{padding:6px; width:28px; display:grid; place-items:center}

    /* ===================
       TOAST (com leve antirruído)
       =================== */
    .toast{position:fixed; right:12px; bottom:12px; display:grid; gap:8px; width:min(360px, 92vw); z-index:60}
    .toast .item{display:flex; gap:10px; align-items:center; padding:10px 12px; border-radius:14px; background:hsl(0 0% 100%/.95); color:#0b1220; border:1px solid hsl(var(--stroke)); box-shadow:0 10px 26px #0002; animation:pop .2s ease}
    @keyframes pop{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none}}

    /* ===================
       INTERVALO CIRCULAR (play/pause estilo vídeo)
       =================== */
    .ic{position:fixed; right:18px; bottom:86px; width:76px;height:76px; border-radius:999px; display:grid;place-items:center; background:conic-gradient(hsl(var(--ring)) 0deg, hsl(var(--ring-2)) 0deg, #ddd 0deg); color:#0b1220; font-size:12px; font-weight:800; opacity:0; transition:.25s; z-index:55; box-shadow:0 8px 24px #0003}
    .ic.show{opacity:1}
    .ic .center{position:relative; z-index:2; display:grid; place-items:center; gap:2px}
    .ic .btnMain{width:34px;height:34px;border-radius:999px;border:1px solid hsl(var(--stroke)); background:linear-gradient(145deg, hsl(var(--glass)), hsl(var(--glass-strong))); display:grid; place-items:center; cursor:pointer}
    .ic.playing .btnMain{opacity:0; pointer-events:none}
    .ic .time{font-weight:900}
    .ic.paused{filter:grayscale(.4); opacity:.9}
    .ic .reset{position:absolute; bottom:4px; right:4px; width:22px;height:22px; border-radius:8px; border:1px solid hsl(var(--stroke)); background:hsl(var(--glass)); display:grid; place-items:center; font-size:12px; cursor:pointer}

    /* ===================
       ASSISTENTE (no topo, ao lado do reset)
       =================== */
    .asstTop{position:relative}
    .asstTop .panel{display:none; position:absolute; right:0; top:48px; background:hsl(0 0% 100%/.98); border:1px solid hsl(var(--stroke)); border-radius:16px; padding:10px; box-shadow:0 10px 26px #0003; width:260px; z-index:70}
    .asstTop.open .panel{display:block}
    .asstTop .grid{display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:8px}
    .asstTop .grid .chip{font-size:12px; text-align:center}

    /* ===================
       MOBILE
       =================== */
    @media (max-width:480px){ .card{grid-template-columns:1fr 136px} }
  </style>
</head>
<body>
  <!-- TOPO -->
  <header class="top">
    <div class="left">
      <div class="brand" aria-label="MFit"></div>
    </div>
    <nav class="nav"><a id="dietLink">Dieta</a></nav>
    <div class="right">
      <!-- Expandir/Recolher todas as seções (sincronizado) -->
      <div class="icon" id="toggleAll" title="Expandir/Recolher">
        <svg id="toggleAllIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg>
      </div>
      <!-- Reset -->
      <div class="icon" id="resetTop" title="Reset progresso">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0114.13-3.36L23 10M1 14l5.36 4.36A9 9 0 0020.49 15"/></svg>
      </div>
      <!-- Assistente Minimalista (toggle) -->
      <div class="icon asstTop" id="asstTop" title="Assistência Minimalista">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M2 9a10 10 0 0120 0c0 3.1-1.5 5.9-4 7.6V18H6v-1.4C3.5 14.9 2 12.1 2 9z"/></svg>
        <div class="panel" id="asstPanel">
          <div style="font-weight:800; margin:2px 0 8px">Assistente</div>
          <div class="grid">
            <button class="chip" data-act="water">💧 Não esqueça a água</button>
            <button class="chip" data-act="timer60">⏱️ Intervalo 60s</button>
            <button class="chip" data-act="autoNext">▶️ Auto-próximo vídeo</button>
            <button class="chip" data-act="motivate">✨ Motivação</button>
            <button class="chip" data-act="silence">🔕 Silenciar lembretes</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main id="app"><!-- Seções renderizadas via JS --></main>

  <!-- Toasts & Intervalo -->
  <div class="toast" id="toast"></div>
  <div class="ic" id="ic" aria-live="polite">
    <div class="center">
      <button class="btnMain" id="icToggle" title="Play/Pause">▶️</button>
      <div class="time" id="icTime">60s</div>
      <button class="reset" id="icReset" title="Reset">🔄</button>
    </div>
  </div>

  <script>
    // ===== Helpers
    const $ = (s, c=document)=>c.querySelector(s);
    const $$ = (s, c=document)=>Array.from(c.querySelectorAll(s));

    // ===== Toast com antirruído simples
    let lastToastAt = 0;
    const toast = (msg, opts={})=>{
      const now = Date.now();
      const minGap = opts.force ? 0 : 900; // evita poluição visual
      if(now - lastToastAt < minGap && !opts.queue) return; // descarta lembretes redundantes
      lastToastAt = now;
      const t = $('#toast');
      const el = document.createElement('div');
      el.className='item'; el.textContent = msg; t.appendChild(el);
      setTimeout(()=>{ el.style.transition='opacity .3s, transform .3s'; el.style.opacity=0; el.style.transform='translateY(6px)'; setTimeout(()=>el.remove(), 320); }, 3500);
    }

    // ===== WebAudio beep
    function beep(duration=180, freq=760){ try{ const actx = new (window.AudioContext||window.webkitAudioContext)(); const o = actx.createOscillator(); const g = actx.createGain(); o.connect(g); g.connect(actx.destination); o.frequency.value=freq; o.type='sine'; o.start(); g.gain.exponentialRampToValueAtTime(0.0001, actx.currentTime + duration/1000); setTimeout(()=>{o.stop(); actx.close&&actx.close();}, duration+30);}catch(e){} }

    // ===== Intervalo circular com play/pause (estilo vídeo)
    const ic = $('#ic'), icTime = $('#icTime'), icToggle = $('#icToggle'), icReset = $('#icReset');
    let timer = { total: 60, remaining: 60, running: false, t0: 0, id: null, vib:false };
    const updateIc = () => {
      icTime.textContent = Math.max(0, Math.ceil(timer.remaining)) + 's';
      const done = Math.min(1, (timer.total - timer.remaining) / timer.total);
      const deg = done * 360; ic.style.background = `conic-gradient(hsl(var(--ring)) ${deg}deg, hsl(var(--ring-2)) 0deg, #ddd 0deg)`;
      icToggle.textContent = timer.running? '⏸️' : '▶️';
      ic.classList.toggle('playing', !!timer.running);
    };
    const tick = () => {
      const dt = (Date.now() - timer.t0) / 1000; timer.t0 = Date.now();
      timer.remaining = Math.max(0, timer.remaining - dt); updateIc();
      if(!timer.vib && timer.remaining <= 5 && timer.remaining > 0){ timer.vib = true; if(navigator.vibrate) navigator.vibrate(60); }
      if(timer.remaining <= 0){ toggleIc(false); ic.classList.remove('show'); beep(180, 820); toast('✅ Intervalo concluído', {force:true}); }
    };    
    const toggleIc = (play) => {
      if(play===undefined) play = !timer.running;
      if(play){ if(timer.running) return; timer.running = true; ic.classList.remove('paused'); timer.t0 = Date.now(); timer.id = setInterval(tick, 180); }
      else { timer.running = false; ic.classList.add('paused'); clearInterval(timer.id); timer.id = null; }
      updateIc();
    };
    const openInterval = (seconds=60)=>{ timer.total = seconds; timer.remaining = seconds; timer.vib=false; updateIc(); ic.classList.add('show'); ic.classList.remove('paused'); toast('⏳ Intervalo ' + seconds + 's'); toggleIc(true); };
    // overlay play/pause via toque no círculo completo
    ic.addEventListener('click', (e)=>{ if(e.target===ic) toggleIc(); });
    icToggle.addEventListener('click', ()=> toggleIc());
    icReset.addEventListener('click', ()=>{ toggleIc(false); timer.remaining = timer.total; timer.vib=false; updateIc(); });

    // ===== Vídeos (tap play/pause + overlay que some)
    function setupMedia(wrap){
      const thumb = wrap.querySelector('.thumb');
      const playBtn = wrap.querySelector('.play button');
      const vidBox = wrap.querySelector('.vid');
      const video = wrap.querySelector('video');
      const tapFX = document.createElement('div'); tapFX.className='tapFX'; tapFX.innerHTML = '<div class="dot">⏯️</div>'; wrap.appendChild(tapFX);

      const start = ()=>{ video.src = thumb.dataset.src; thumb.style.opacity=1; // fade out
        thumb.querySelector('.play').style.opacity=0; setTimeout(()=>{ thumb.style.display='none'; vidBox.style.display='block'; video.play().catch(()=>{}); }, 200); };
      playBtn.addEventListener('click', (e)=>{ e.stopPropagation(); start(); });
      thumb.addEventListener('click', start);

      const flash = (icon)=>{ tapFX.querySelector('.dot').textContent = icon; tapFX.classList.remove('show'); void tapFX.offsetWidth; tapFX.classList.add('show'); setTimeout(()=> tapFX.classList.remove('show'), 280); };
      video.addEventListener('click', ()=>{ if(video.paused){ video.play(); flash('▶️'); } else { video.pause(); flash('⏸️'); } });

      // botão fechar volta a thumb
      wrap.querySelector('.back').addEventListener('click', ()=>{ video.pause(); video.src=''; vidBox.style.display='none'; thumb.style.display='block'; thumb.style.opacity=1; thumb.querySelector('.play').style.opacity=1; });
    }

    // ===== Dados dos exercícios (mantém layout e textos originais que você enviou)
    const VID = {
      sumo_dumbbell: 'https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-sumo-squat-front.mp4',
      legpress: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-leg-press-front.mp4',
      aducao: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-machine-hip-adduction-front.mp4',
      flexora_sentada: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-seated-leg-curl-side.mp4',
      flexora_sentada_alt: 'https://media.musclewiki.com/media/uploads/videos/branded/machines/_1080/Seated_Leg_Curl_FR_1080.mp4',
      panturrilha: 'https://media.musclewiki.com/media/uploads/videos/branded/female-calves-stretch-variation-3-side.mp4',
      canivete: 'https://media.musclewiki.com/media/uploads/videos/branded/bodyweight/_1080/V-Up_FR_1080.mp4',
      esteira: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Cardio-treadmill-walk-side.mp4',
      front_rack_squat: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-front-rack-squat-side.mp4',
      abducao: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Machine-machine-hip-abduction-front.mp4',
      eliptico: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Cardio-elliptical-side.mp4',
      afundo_barra: 'https://media.musclewiki.com/media/uploads/videos/branded/female-barbell-reverse-lunge-side.mp4',
      sumo_step_db: 'https://media.musclewiki.com/media/uploads/videos/branded/dumbbells/_1080/DB_Sumo_Squat_FR_1080.mp4',
      abducao_hd: 'https://media.musclewiki.com/media/uploads/videos/branded/machines/_1080/Hip_Abduction_FR_1080.mp4',
      extensora: 'https://media.musclewiki.com/media/uploads/videos/branded/female-machine-leg-extension-side.mp4',
      extensora_uni: 'https://media.musclewiki.com/media/uploads/videos/branded/machines/_1080/Single_Leg_Extension_FR_1080.mp4',
      legpress_hd: 'https://media.musclewiki.com/media/uploads/videos/branded/machines/_1080/Leg_Press_FR_1080.mp4',
      along_ombro_tric: 'https://media.musclewiki.com/media/uploads/videos/branded/female-shoulders-stretch-variation-1-front.mp4',
      bike: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Cardio-stationary-bike-side.mp4',
      crunch: 'https://media.musclewiki.com/media/uploads/videos/branded/bodyweight/_1080/Crunch_FR_1080.mp4',
      triceps_uni_polia: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Cables-cable-single-arm-rope-pushdown-side.mp4',
      along_peito: 'https://media.musclewiki.com/media/uploads/videos/branded/female-chest-stretch-variation-1-side.mp4',
      mobilidade_ombro: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Recovery-thoracic-extensions-via-shoulder-flexion-foam-roller-front.mp4',
      rosca_alt: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-curl-side.mp4',
      triceps_corda: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Cables-cable-push-down-side.mp4',
      fly_incl: 'https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-incline-chest-flys-side.mp4',
      fly: 'https://media.musclewiki.com/media/uploads/videos/branded/female-dumbbell-incline-chest-fly-front.mp4',
      martelo: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-hammer-curl-side.mp4',
      press_neutro: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-neutral-overhead-press-side.mp4',
      press_neutro_alt: 'https://media.musclewiki.com/media/uploads/videos/branded/dumbbells/_1080/Neutral_Grip_DB_Press_FR_1080.mp4',
      canivete_alt: 'https://media.musclewiki.com/media/uploads/videos/branded/bodyweight/_1080/V-Up_FR_1080.mp4',
      front_raise: 'https://media.musclewiki.com/media/uploads/videos/branded/female-Dumbbells-dumbbell-front-raise-side.mp4',
      puxada_alta_neutra: 'https://media.musclewiki.com/media/uploads/videos/branded/female-machine-pulldown-side.mp4',
      remada_tri: 'https://media.musclewiki.com/media/uploads/videos/branded/cables/_1080/Seated_Row_V_Grip_FR_1080.mp4',
      remada_tri_alt: 'https://media.musclewiki.com/media/uploads/videos/branded/female-machine-seated-cable-row-front.mp4'
    };

    const TREINOS = [
      {
        titulo: 'Posterior & Glúteo',
        itens:[
          {nome:'Agachamento Sumô com Halteres', series:'3x10/10/10 (Drop faz tudo e conta 1 série)', carga:'0kg', int:60, src: VID.sumo_dumbbell},
          {nome:'Leg Press 45°', series:'4x15 pés colados + 15 afastados', carga:'12kg', int:40, src: VID.legpress},
          {nome:'Adução de Quadril Máquina', series:'3x10/10/10 (Drop)', carga:'0kg', int:60, src: VID.aducao},
          {nome:'Cadeira Flexora', series:'3x10/10/10 (Drop)', carga:'0kg', int:60, src: VID.flexora_sentada_alt},
          {nome:'Cadeira Flexora Unilateral', series:'3x10/10/10/10 (Drop)', carga:'0kg', int:60, src: VID.flexora_sentada},
          {nome:'Panturrilha no Step', series:'4x15', carga:'0kg', int:30, src: VID.panturrilha},
          {nome:'Abdominal Canivete', series:'4x15', carga:'0kg', int:30, src: VID.canivete},
          {nome:'Esteira Caminhada', series:'30 reps', carga:'—', int:30, src: VID.esteira},
        ]
      },
      {
        titulo: 'Quadríceps',
        itens:[
          {nome:'Agachamento com Halteres', series:'3x10+10+10 (Drop)', carga:'0kg', int:60, src: VID.front_rack_squat},
          {nome:'Abdução de Quadril Máquina', series:'3x10+10+10 (Drop)', carga:'0kg', int:60, src: VID.abducao},
          {nome:'Elíptico', series:'25 reps', carga:'0kg', int:30, src: VID.eliptico},
          {nome:'Afundo com Barra Livre', series:'3x12 • 3x10 • 2x8', carga:'0kg', int:60, src: VID.afundo_barra},
          {nome:'Agachamento Sumô no Step com Halteres', series:'3x10+10+10 (Drop)', carga:'0kg', int:60, src: VID.sumo_step_db},
          {nome:'Abdução de Quadril Máquina', series:'3x10+10+10 (Drop)', carga:'0kg', int:60, src: VID.abducao_hd},
          {nome:'Cadeira Extensora', series:'3x10+10+10 (Drop)', carga:'0kg', int:60, src: VID.extensora},
          {nome:'Cadeira Extensora Unilateral', series:'3x10+10+10 (Drop)', carga:'0kg', int:60, src: VID.extensora_uni},
          {nome:'Leg Press 45° Unilateral', series:'3x12 • 3x10 • 2x8', carga:'0kg', int:60, src: VID.legpress_hd},
        ]
      },
      {
        titulo: 'Peito, Tríceps e Bíceps',
        itens:[
          {nome:'Alongamento de Ombros e Tríceps II', series:'3x20', carga:'0kg', int:30, src: VID.along_ombro_tric},
          {nome:'Bike Spinning Sentada', series:'40 reps', carga:'—', int:30, src: VID.bike},
          {nome:'Abdominal Supra Solo', series:'5x15', carga:'0kg', int:40, src: VID.crunch},
          {nome:'Tríceps Unilateral na Polia Alta (Neutra)', series:'3x15', carga:'0kg', int:30, src: VID.triceps_uni_polia},
          {nome:'Alongamento de Peitoral (Espaldar)', series:'3x15', carga:'0kg', int:40, src: VID.along_peito},
          {nome:'Mobilidade de Ombro III', series:'3x20', carga:'0kg', int:30, src: VID.mobilidade_ombro},
          {nome:'Rosca Alternada com Halteres', series:'3x15', carga:'0kg', int:30, src: VID.rosca_alt},
          {nome:'Tríceps na Polia com Corda', series:'3x15 lento + 15 curto', carga:'0kg', int:30, src: VID.triceps_corda},
          {nome:'Crucifixo com Halteres', series:'4x12', carga:'0kg', int:30, src: VID.fly},
          {nome:'Crucifixo Inclinado com Halteres', series:'4x12', carga:'0kg', int:30, src: VID.fly_incl},
          {nome:'Rosca Martelo com Halteres', series:'4x12', carga:'0kg', int:30, src: VID.martelo},
        ]
      },
      {
        titulo: 'Ombro & Costas',
        itens:[
          {nome:'Puxada Alta (pegada neutra)', series:'3x10/8/6 (Drop)', carga:'0kg', int:30, src: VID.puxada_alta_neutra},
          {nome:'Abdominal Canivete', series:'3x12', carga:'0kg', int:30, src: VID.canivete_alt},
          {nome:'Esteira Caminhada', series:'40 reps', carga:'—', int:30, src: VID.esteira},
          {nome:'Elevação Lateral Unilateral (sentado)', series:'3x10/8/6 (Drop)', carga:'0kg', int:30, src: VID.press_neutro},
          {nome:'Elevação Frontal Alternada', series:'3x12', carga:'4–6kg', int:30, src: VID.front_raise},
          {nome:'Desenvolvimento com Halteres (neutra)', series:'3x10/8/6 (Drop)', carga:'0kg', int:30, src: VID.press_neutro_alt},
          {nome:'Puxada Neutra Triângulo', series:'3x10/8/6 (Drop)', carga:'0kg', int:30, src: VID.puxada_alta_neutra},
          {nome:'Remada Baixa Triângulo', series:'3x10/8/6 (Drop)', carga:'0kg', int:30, src: VID.remada_tri},
          {nome:'Puxada Aberta Barra Reta', series:'3x10/8/6 (Drop)', carga:'0kg', int:30, src: VID.puxada_alta_neutra}
        ]
      }
    ];

    // ===== Render
    const app = $('#app');
    TREINOS.forEach((sec, idx)=>{
      const el = document.createElement('section'); el.className='section'; el.dataset.idx = idx;
      el.innerHTML = `
        <div class="section-header" data-sec="${idx}">
          <div class="title">${sec.titulo} <span class="count">(0/${sec.itens.length})</span></div>
          <div class="plus">+</div>
        </div>
        <div class="underline"></div>
        <div class="panel"></div>
      `;
      app.appendChild(el);
      const panel = $('.panel', el);
      sec.itens.forEach(it=>{
        const card = document.createElement('article'); card.className='card';
        card.innerHTML = `
          <div>
            <div class="title-sm">${it.nome}</div>
            <div class="meta"><b>Séries:</b> ${it.series}</div>
            <div class="meta"><b>Carga:</b> ${it.carga}</div>
            <div class="actions">
              <button class="chip start">Intervalo: ${it.int}s</button>
              <button class="chip thin conclude" title="Concluir exercício">➜</button>
            </div>
          </div>
          <div class="media">
            <div class="thumb" data-src="${it.src}">
              <div class="play"><button title="Assistir">▶️</button></div>
            </div>
            <div class="vid">
              <button class="back" title="Fechar">✖</button>
              <video playsinline muted loop></video>
            </div>
          </div>
        `;
        panel.appendChild(card);
        setupMedia($('.media', card));
      });
    });

    // ===== Abertura/fecho de seção
    function setOpen(sectionEl, v){
      const plus = $('.plus', sectionEl); const panel = $('.panel', sectionEl);
      plus.classList.toggle('open', v); plus.textContent = v? '−' : '+'; panel.classList.toggle('open', v);
      if(v){ $$('.card', panel).forEach(c=>{ c.classList.add('fx-fade'); setTimeout(()=>c.classList.remove('fx-fade'), 380);}); }
      // Se fechar seção, esconda o temporizador (precisão que você pediu)
      if(!v){ ic.classList.remove('show'); toggleIc(false); }
      syncToggleAllIcon();
    }
    $$('.section').forEach(secEl=>{ const head = $('.section-header', secEl); setOpen(secEl, false); head.addEventListener('click', ()=> setOpen(secEl, !$('.plus', secEl).classList.contains('open')) ); });

    // ===== Contador por seção
    function updateCounts(){
      $$('.section').forEach(secEl=>{
        const total = $$('.card', secEl).length; const done = $$('.card.done', secEl).length;
        $('.count', secEl).textContent = `(${done}/${total})`;
      });
    }

    // ===== Topo: dieta + reset + expandir/recolher sincronizado
    $('#dietLink').addEventListener('click', ()=> toast('🍎 "Dieta" — em breve'));
    $('#resetTop').addEventListener('click', ()=>{
      $$('.card.done').forEach(c=>c.classList.remove('done')); updateCounts();
      toast('🔄 Reset aplicado', {force:true});
    });
    function allSectionsOpen(){ return $$('.section').every(s=> $('.panel', s).classList.contains('open')); }
    function allSectionsClosed(){ return $$('.section').every(s=> !$('.panel', s).classList.contains('open')); }
    function syncToggleAllIcon(){
      const svg = $('#toggleAllIcon');
      svg.innerHTML = allSectionsOpen() ? '<path d="M5 12h14"/>' : '<path d="M12 5v14M5 12h14"/>';
    }
    $('#toggleAll').addEventListener('click', ()=>{
      const openAll = !allSectionsOpen();
      $$('.section').forEach(s=> setOpen(s, openAll));
      syncToggleAllIcon();
    });
    syncToggleAllIcon();

    // ===== Interações: intervalo + concluir (seta discreta) + contadores
    document.body.addEventListener('click', (e)=>{
      const start = e.target.closest('.start'); if(start){ const int = parseInt(start.textContent.replace(/\D/g,'')) || 60; openInterval(int); }
      const concl = e.target.closest('.conclude'); if(concl){ const card = concl.closest('.card'); card.classList.toggle('done'); if(card.classList.contains('done')){ toast('✅ Exercício concluído'); } updateCounts(); }
    });

    // ===== Assistente Minimalista (automático + toggle no topo)
    const asstTop = $('#asstTop'); const asstPanel = $('#asstPanel');
    asstTop.addEventListener('click', (e)=>{ asstTop.classList.toggle('open'); e.stopPropagation(); });
    document.addEventListener('click', ()=> asstTop.classList.remove('open'));

    let remindersOn = true; let autoNext = false; let waterTimer = null; let lastManualAt = Date.now();
    function startWater(){ clearInterval(waterTimer); waterTimer = setInterval(()=>{ const diff = Date.now() - lastManualAt; if(remindersOn && diff>6000) toast('💧 Não esqueça a água'); }, 20*60*1000); }
    startWater(); // ON por padrão, já interagindo ao entrar

    asstPanel.addEventListener('click', (e)=>{
      const b = e.target.closest('.chip'); if(!b) return; const act = b.dataset.act; lastManualAt = Date.now();
      if(act==='water'){ toast('💧 Lembrete de água reativado'); startWater(); }
      if(act==='timer60'){ openInterval(60); }
      if(act==='autoNext'){ autoNext = !autoNext; toast('Auto-próximo vídeo: ' + (autoNext? 'ON':'OFF')); }
      if(act==='motivate'){ toast('✨ Você tá indo muito bem! Mantenha a postura e respiração.'); }
      if(act==='silence'){ remindersOn = !remindersOn; toast('Lembretes: ' + (remindersOn? 'ON':'OFF')); }
    });

    // ===== Auto-próximo (se decidir desligar loop dos vídeos)
    document.body.addEventListener('ended', (e)=>{
      if(e.target.tagName!=='VIDEO') return; if(!autoNext) return; 
      const media = e.target.closest('.media'); const next = media.closest('.card').nextElementSibling; if(next){ const btn = $('.thumb .play button', next); if(btn){ btn.click(); toast('▶️ Próximo exercício'); } }
    }, true);

    // ===== Inicialização
    updateCounts();
  </script>
</body>
</html>
